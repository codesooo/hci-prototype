<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>HCI-Prototype</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <style>
          .autocomplete > div.active {
  background: #e0e5f6;
  color: #000;
}

.autocomplete > div {
  background: #f1f3f499;
  padding: .2rem .6rem;
}

section {
  width: 500px;
  padding: 1.5rem 1.6rem;
  box-shadow: 0 0 1rem rgba(0, 0, 0, .05);  
  border-radius: 5px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  background: #fff;
  margin-top: 2rem;
}

@import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  outline: none;
  word-break: break-all;
  font-family: Pretendard;
}


mark {
  background: #77bdff90;
}
        </style>
      </head>
  <body>
    <nav class="navbar bg-body-tertiary mb-3 ">
        <div class="container-fluid">
          <span class="navbar-brand mb-0">HCI</span>
        </div>
      </nav>
      <div class="container-fluid" >
        <div class="row" >
          <div class="col" style="background-color: ;">            
            <div class="row mb-2">
                <div class="col">
                    <div class="mb-3">
                        <label  for="name" class="form-label">이름</label>
                        <input type="text" class="form-control" id="name" name="name" placeholder="이름을 입력해주세요" required
                        >
                    </div>
                   
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label  for="studentId" class="form-label">학번</label>
                        <input type="text" class="form-control" id="studentId" name="studentId" 
                        placeholder="학번을 입력해주세요" required>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label  for="major" class="form-label">전공</label>
                        <input type="text" class="form-control" id="major" name="major"
                        placeholder="전공을 입력해주세요" required>
                    </div>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col">
                    <div class="mb-3">
                        <label  for="lecture" class="form-label">강의명</label>
                        <input type="text" class="form-control" id="lecture" name="lecture"
                        placeholder="강의명을 입력해주세요" required>
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label  for="recipientName" class="form-label">받는 사람</label>
                        <input type="text" class="form-control" id="recipientName" name="recipientName"
                        placeholder="받는 사람의 이름을 입력해주세요" required> 
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label  for="recipientEmail" class="form-label">&nbsp; </label>
                        <input type="email" class="form-control" id="recipientEmail" name="recipientEmail" 
                        placeholder="받는 사람의 이메일을 입력해주세요" required>
                    </div>
                </div>
            </div>

            <div class="mb-3">
              <label for="formFile" class="form-label" style="font-size: 1.2em;">첨부 파일</label>
              <input class="form-control" type="file" id="formFile">
          </div>
          
            <label for="speaking" style="font-size: 1.2em;" class="col">말투</label>
            <div class="row mb-4" id="speaking">
                <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                  <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
                  <label class="btn btn-outline-secondary" for="btnradio1">정중하게</label>
                
                  <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                  <label class="btn btn-outline-secondary" for="btnradio2">친근하게</label>
                </div>
            </div>
            
            <label for="situation" class="mb-3" style="font-size: 1.2em;">상황</label>
            <div class="row mb-4" id="situation">
                <div class="col">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="situation" value="gradeInquiry" checked>
                    <label class="form-check-label" for="flexRadioDefault1">
                      성적 문의
                    </label>
                  </div>
                </div>
                <div class="col">
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="situation" value="attendanceInquiry" >
                      <label class="form-check-label" for="flexRadioDefault1">
                        출석 문의
                      </label>
                    </div>
                </div>
                <div class="col">
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" >
                      <label class="form-check-label" for="flexRadioDefault1">
                        수강 신청 관련 문의
                      </label>
                    </div>
                  </div>
                <div class="col">
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" >
                      <label class="form-check-label" for="flexRadioDefault1">
                        기타
                      </label>
                    </div>
                </div>

            </div>

            <div class="mb-3">
                <label for="details" class="form-label" style="font-size: 1.2em;">세부 사항 입력</label>
                <textarea class="form-control" id="details" name="details"
                 placeholder="세부 사항을 입력해주세요" rows="2"
                 autocomplete="off"></textarea>
                 <div class="autocomplete"></div>
            </div>
            <div id="additionalDetails">
              <!-- 추가적인 세부 사항 입력란이 여기에 동적으로 추가됩니다. -->
            </div>
        
            <div>
            <button type="button" class="btn btn-secondary" onclick="showAdditionalDetails()">추가 세부 사항 입력</button>
            </div>
            <div>
            

            <button type="button" class="btn btn-outline-dark" onclick="generateMail()" style="width: 100px; float: right; margin-left: 15px;">
              완료</button>
              </div>
          </div>
          
          <div class="col mt-1">
            <div class="">
              <label for="mailSubject" class="form-label"></label>
              <textarea class="form-control" id="mailSubject" rows="2"
              placeholder="제목" style="font-size: 1.2em;"></textarea>
            </div>
            <div class="mb-3">
              <label for="mailContent" class="form-label"></label>
              <textarea class="form-control" id="mailContent" rows="23"></textarea>
            </div>

            <button type="button" class="btn btn-info btn-lg" onclick="sendEmail()" style="width: 300px; float: right; margin-left: 15px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send" viewBox="0 0 16 16">
                <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"/>
              </svg>  전송하기</button>
            <button type="button" class="btn btn-secondary btn-lg" style="width: 300px; float: right;">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
                <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
              </svg>  재작성</button>
            
          </div>
        </div>
      </div>
      <script>
        const dataList = ["비협조적인 팀원", "예비군 훈련으로 인한 시험 불참"];
  
        const $search = document.querySelector("#search");
        const $autoComplete = document.querySelector(".autocomplete");
  
        let nowIndex = 0;
        let matchDataList = [];
  
        $search.addEventListener("input", (event) => {
          // 입력된 문장을 공백으로 분리
          const words = $search.value.trim().split(/\s+/);
  
          // 현재 입력 중인 단어
          const currentWord = words[words.length - 1];
  
          // 현재 입력 중인 단어의 첫 글자에 대한 자동완성 필터링
          matchDataList = currentWord
            ? dataList.filter((label) => label.startsWith(currentWord))
            : [];
  
          // 각 단어에 대해 자동완성 결과 생성 및 표시
          showList(matchDataList, currentWord, nowIndex);
        });
  
        $search.addEventListener("keydown", (event) => {
          switch (event.keyCode) {
            // UP KEY
            case 38:
              nowIndex = Math.max(nowIndex - 1, 0);
              break;
  
            // DOWN KEY
            case 40:
              nowIndex = Math.min(nowIndex + 1, matchDataList.length - 1);
              break;
          }
  
          // 화면에 표시된 자동완성 단어 강조 표시
          updateActiveItem(nowIndex);
        });
  
        $search.addEventListener("keyup", (event) => {
          if (event.keyCode === 13) {
            // 엔터 키
            event.preventDefault(); // textarea에서의 엔터 키 기본 동작을 막음
  
            const words = $search.value.trim().split(/\s+/);
  
            // 현재 입력 중인 단어에 대한 자동완성이 선택된 경우
            if (matchDataList.length > 0) {
              words[words.length - 1] = matchDataList[nowIndex] || "";
              $search.value = words.join(" ");
  
              // 자동완성 결과 및 인덱스 초기화
              $autoComplete.innerHTML = "";
              nowIndex = 0;
            }
  
            // 초기화
            nowIndex = 0;
            matchDataList.length = 0;
          }
        });
  
        const showList = (data, currentWord, nowIndex) => {
          $autoComplete.innerHTML = data
            .map(
              (label, index) => `
                <div class='${nowIndex === index ? "active" : ""}'>
                  ${label.replace(new RegExp(`(${currentWord})`, "g"), "<mark>$1</mark>")}
                </div>
              `
            )
            .join("");
        };
  
        const updateActiveItem = (index) => {
          const items = $autoComplete.querySelectorAll(".autocomplete > div");
          items.forEach((item, i) => {
            if (i === index) {
              item.classList.add("active");
            } else {
              item.classList.remove("active");
            }
          });
        };

        var trainingDateInfo = ''; // 훈련 날짜 및 기간 저장 변수
      var teammateInfo = ''; // 비협조적인 팀원 정보 저장 변수

      function typeWriter(textarea, content, index) {
    if (index < content.length) {
      textarea.value += content.charAt(index);
      index++;
      setTimeout(function () {
        typeWriter(textarea, content, index);
      }, 10); // 10밀리초마다 한 글자씩 추가
    }
  }


      function showAdditionalDetails() {
        var situation = document.querySelector('input[name="situation"]:checked');
        var details = document.getElementById('details').value;

        if (!situation) {
          alert("상황을 선택하세요.");
          return;
        }

        // 추가적인 세부 사항 입력란을 동적으로 생성합니다.
        var additionalDetailsContainer = document.getElementById('additionalDetails');
        additionalDetailsContainer.innerHTML = ''; // 기존 내용 초기화

        var trainingDateTextarea, teammateInfoTextarea; // 변수를 여기에서 선언

        if (situation.value === 'gradeInquiry' && details === '예비군 훈련으로 인한 시험 불참') {
          trainingDateTextarea = document.createElement('textarea');
          trainingDateTextarea.name = 'trainingDate';
          trainingDateTextarea.className = 'form-control';
          trainingDateTextarea.placeholder = '훈련 날짜 및 기간을 입력해주세요.';
          additionalDetailsContainer.appendChild(trainingDateTextarea);
        } else if (situation.value === 'gradeInquiry' && details === '비협조적인 팀원') {
          teammateInfoTextarea = document.createElement('textarea');
          teammateInfoTextarea.name = 'teammateInfo';
          teammateInfoTextarea.className = 'form-control';
          teammateInfoTextarea.placeholder = '비협조적인 팀원의 [학과] [학번] [이름]을 입력해주세요.';
          additionalDetailsContainer.appendChild(teammateInfoTextarea);
        } else if (situation.value === 'gradeInquiry' && details === '시험지 확인') {
          checkExamPaperTextarea = document.createElement('textarea');
          checkExamPaperTextarea.name = 'checkExamPaper';
          checkExamPaperTextarea.className = 'form-control';
          checkExamPaperTextarea.placeholder = '확인하고자 하는 시험이 중간고사인지 기말고사인지 알려주세요.';
          additionalDetailsContainer.appendChild(checkExamPaperTextarea);
        } else if (situation.value === 'attendanceInquiry' && details === '지하철 파업으로 인한 지각') {
          checkSubwayTextarea = document.createElement('textarea');
          checkSubwayTextarea.name = 'subwayInfo';
          checkSubwayTextarea.className = 'form-control';
          checkSubwayTextarea.placeholder = '지하철 노선과 탑승한 시간대를 알려주세요.';
          additionalDetailsContainer.appendChild(checkSubwayTextarea);
        }
        // 다른 상황 및 세부사항에 대한 추가적인 처리를 여기에 추가

        // 입력받은 값을 전역 변수에 저장
        trainingDateInfo = trainingDateTextarea ? trainingDateTextarea.value : '';
        teammateInfo = teammateInfoTextarea ? teammateInfoTextarea.value : '';
        examInfo = checkExamPaperTextarea ? checkExamPaperTextarea.value : '';
        subwayInfo = checkSubwayTextarea ? checkSubwayTextarea.value : '';
      }

      function generateMail() {
        var name = document.getElementById('name').value;
        var studentId = document.getElementById('studentId').value;
        var major = document.getElementById('major').value;
        var lecture = document.getElementById('lecture').value;
        var recipientName = document.getElementById('recipientName').value;
        var recipientEmail = document.getElementById('recipientEmail').value;

        var situation = document.querySelector('input[name="situation"]:checked');
        var details = document.getElementById('details').value;

        if (!situation) {
          alert("상황을 선택하세요.");
          return;
        }

        

        var tone = document.querySelector('input[name="btnradio"]:checked').id === 'btnradio1' ? '정중한' : '친근한';

        if (situation.value === 'gradeInquiry' && details === '비협조적인 팀원') {
          var teammateInfo = document.getElementById('additionalDetails').querySelector('textarea[name="teammateInfo"]').value;
          var mailSubject = "성적 문의" + "| " + major + " " + studentId + " " + name + " 입니다.";
          if (tone === '정중한') {
          var mailContent = "- " + recipientName + " 교수님께. \n\n안녕하세요, " + recipientName + " 교수님.\n\n";
          mailContent += "저는 " + lecture + "을(를) 수강하고 있는 " + major + " " + studentId + " " + name + " 입니다.\n";
          mailContent += "다름이 아니라, 팀 프로젝트를 진행하는 중 문제가 생겨 연락 드렸습니다.";
          mailContent += " 저희 팀원 중 한 명인 " + teammateInfo + " 학생이 비협조적인 행동을 보여 프로젝트 진행에 차질이 생겼습니다. ";
          mailContent += "프로젝트에 동참을 유도하기 위해 개인적으로 연락을 몇 번 시도했으나, ";
          mailContent += "여전히 비협조적인 모습을 보이고 있습니다.\n\n";
          mailContent += "따라서 " + teammateInfo + " 학생의 태도를 프로젝트의 개별 성과에 반영해주시면 좋겠습니다."; 
          mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다. \n날이 추운데 감기 조심하시기 바랍니다.\n\n";
          }
          else if (tone === '친근한') {
              var mailContent = "- " + recipientName + " 교수님께. \n\n교수님, 안녕하세요!\n\n";
              mailContent += lecture + "을(를) 수강 중인 " + major + " " + studentId + " " + name + " 입니다.\n";
              mailContent += "다름이 아니라, 팀 프로젝트를 진행하는 중 문제가 생겨 연락 드리게 되었어요.\n\n";
              mailContent += "저희 팀원 중 한 명인 " + teammateInfo + " 학생이 비협조적인 행동을 보여 프로젝트 진행에 차질이 생겼습니다.";
              mailContent += " 프로젝트에 동참을 유도하기 위해 개인적으로 연락을 몇 번 시도했으나, 여전히 비협조적인 모습을 보이고 있습니다.\n";
              mailContent += "혹시 이에 대해 조언이나 지도해 주실 수 있을까요?\n";
              mailContent += "그리고 학생의 태도를 프로젝트의 개별 성과에 반영해주시길 원합니다.\n";
              mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다!\n날이 추운데 감기 조심하시고 좋은 하루 보내세요 :)\n\n";
          }
        } else if (situation.value === 'gradeInquiry' && details === '예비군 훈련으로 인한 시험 불참') {
          var trainingDateInfo = document.getElementById('additionalDetails').querySelector('textarea[name="trainingDate"]').value;
          var mailSubject = "성적 문의" + "| " + major + " " + studentId + " " + name + " 입니다.";
          if (tone === '정중한') {
          var mailContent = "- " + recipientName + " 교수님께. \n\n안녕하세요, " + recipientName + " 교수님.\n\n";
          mailContent += "저는 " + lecture + "을(를) 수강하고 있는 " + major + " " + studentId + " " + name + " 입니다.\n";
          mailContent += "이번 예비군 훈련으로 인해 " + trainingDateInfo + " 동안 군 복무 의무를 수행해야 합니다.\n";
          mailContent += "제가 참여하는 예비군 훈련이 기말고사 시험과 겹쳐서 시험을 보지 못할 것 같습니다.";
          mailContent += "이와 관련하여 몇 가지 질문 사항이 있어 연락 드립니다.\n\n";
          mailContent += "1. 예비군 훈련으로 인해 시험에 불이익을 받지 않도록 하기 위해 필요한 조치가 있을까요?\n";
          mailContent += "2. 다른 날에 따로 시험을 봐도 괜찮을까요?\n\n";
          mailContent += "또한 군 복무와 관련된 서류 또는 확인서가 필요하다면 즉시 제출하도록 하겠습니다.\n";
          mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다.\n날이 추운데 감기 조심하시기 바랍니다.\n\n";
          }
          
          else if (tone === '친근한') {
            var mailContent = "- " + recipientName + " 교수님께. \n\n교수님, 안녕하세요!\n\n";
            mailContent += lecture + "을(를) 수강 중인 " + major + " " + studentId + " " + name + " 입니다.\n";
            mailContent += "이번 예비군 훈련으로 인해 " + trainingDateInfo + " 동안 군 복무 의무를 수행해야 합니다.\n";
            mailContent += "제가 참여하는 예비군 훈련이 기말고사 시험과 겹쳐서 시험을 보지 못할 것 같습니다. ";
            mailContent += "이와 관련하여 몇 가지 질문 사항이 있어 연락 드립니다!\n\n";
            mailContent += "1. 예비군 훈련으로 인해 시험에 불이익을 받지 않도록 하기 위해 필요한 조치가 있을까요?\n";
            mailContent += "2. 다른 날에 따로 시험을 봐도 괜찮을까요?\n\n";
            mailContent += "또한 군 복무와 관련된 서류 또는 확인서가 필요하다면 즉시 제출하도록 하겠습니다.\n";
            mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다!\n날이 추운데 감기 조심하시고 좋은 하루 보내세요 :)\n\n";
          }
        } else if (situation.value === 'gradeInquiry' && details === '시험지 확인') {
          var examInfo = document.getElementById('additionalDetails').querySelector('textarea[name="checkExamPaper"]').value;
          var mailSubject = "시험 관련 문의" + "| " + major + " " + studentId + " " + name + " 입니다.";
          if (tone === '정중한') {
          var mailContent = "- " + recipientName + " 교수님께. \n\n안녕하세요, " + recipientName + " 교수님.\n\n";
          mailContent += "저는 " + lecture + "을(를) 수강하고 있는 " + major + " " + studentId + " " + name + " 입니다.\n";
          mailContent += "이번 학기 " + examInfo + " 성적이 제가 예상한 것보다 낮아서 어떤 부분에서 부족했는지 알고 싶어서 연락 드립니다.\n";
          mailContent += examInfo + " 시험지를 확인하게 해주신다면 앞으로 부족한 부분을 보완하여 공부하도록 하겠습니다.\n";
          mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다. \n날이 추운데 감기 조심하시기 바랍니다.\n\n";
         }
          else if (tone === '친근한') {
            var mailContent = "- " + recipientName + " 교수님께. \n\n교수님, 안녕하세요!\n\n";
            mailContent += lecture + "을(를) 수강 중인 " + major + " " + studentId + " " + name + " 입니다.\n";
            mailContent += "이번 학기 " + examInfo + " 성적이 제가 예상한 것보다 낮아서 어떤 부분에서 부족했는지 알고 싶어서 연락 드리게 되었어요!\n";
            mailContent += examInfo + " 시험지를 확인하게 해주신다면 앞으로 부족한 부분을 보완하여 열심히 공부하겠습니다 :)\n";
            mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다!\n날이 추운데 감기 조심하시고 좋은 하루 보내세요 :)\n\n";
          }
        } else if (situation.value === 'attendanceInquiry' && details === '지하철 파업으로 인한 지각') {
          var subwayInfo = document.getElementById('additionalDetails').querySelector('textarea[name="subwayInfo"]').value;
          var mailSubject = "시험 관련 문의" + "| " + major + " " + studentId + " " + name + " 입니다.";
          if (tone === '정중한') {
          var mailContent = "- " + recipientName + " 교수님께. \n\n안녕하세요, " + recipientName + " 교수님.\n\n";
          mailContent += "저는 " + lecture + "을(를) 수강하고 있는 " + major + " " + studentId + " " + name + " 입니다.\n";
          mailContent += "오늘 철도노조 파업으로 인해 지하철이 연착되어 수업에 늦게 도착할 것 같아 연락 드립니다.\n";
          mailContent += "제가 탑승한 지하철 정보는 다음과 같습니다. : " + subwayInfo + "\n";
          mailContent += "지연증명서를 발급받아 교수님께 제출하면 지각 인정이 가능할지 문의 드립니다.\n";
          mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다. \n날이 추운데 감기 조심하시기 바랍니다.\n\n";
         }
          else if (tone === '친근한') {
            var mailContent = "- " + recipientName + " 교수님께. \n\n교수님, 안녕하세요!\n\n";
            mailContent += lecture + "을(를) 수강 중인 " + major + " " + studentId + " " + name + " 입니다.\n";
            mailContent += "오늘 철도노조 파업으로 인해 지하철이 연착되어 수업에 늦게 도착할 것 같아 연락 드립니다.\n\n";
            mailContent += "발급받아 교수님께 제출하면 지각 인정이 가능할까요?\n";
            mailContent += "제가 탑승한 지하철 정보는 다음과 같습니다. : " + subwayInfo + "\n";
            mailContent += "\n바쁘신 와중에 메일 읽어주셔서 감사합니다!\n날이 추운데 감기 조심하시고 좋은 하루 보내세요 :)\n\n";
          }
        }
        // 다른 상황에 대한 메일 내용 추가

        mailContent += "- " + name + " 드림."; 

        

        var mailSubjectTextarea = document.getElementById('mailSubject');
    var mailContentTextarea = document.getElementById('mailContent');

    mailSubjectTextarea.value = mailSubject;
    mailContentTextarea.value = '';

    // 문자열을 한 글자씩 나타내는 타이핑 효과 함수 호출
    typeWriter(mailContentTextarea, mailContent, 0);
        }
      </script>
  </body>
  
</html>